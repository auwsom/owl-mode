<html>
	<head>
		<title>FPT</title>
		<meta name="copyright" content="Copyright 2013, Small Picture, Inc.">
		<script src="./forked_concord/libraries/jquery-1.9.1.min.js"></script>  
		<link href="./forked_concord/libraries/bootstrap.css" rel="stylesheet">
		<script src="./forked_concord/libraries/bootstrap.min.js"></script>
		
		<link rel="stylesheet" href="./forked_concord/concord.css"/>
		<script src="./forked_concord/concord.js"></script>
		<script src="./forked_concord/concordUtils.js"></script>
		
		<script src="./owllibs/pageStore.js"></script>
		<script src="./owllibs/navHistory.js"></script>
		<script src="./owllibs/main.js"></script>
		
		<link href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
		
		<link rel="stylesheet" href="./css/main.css"/>	
		</head>
	<body>

		<div class="divMenubar" id="idMenubar">
			<div class="topbar-wrapper" style="z-index: 0; opacity: 1;">
				<div class="navbar navbar-fixed-top" data-dropdown="dropdown">
					<div class="navbar-inner">
						<div class="container">
							<a class="brand" href="index.html"><span id="idMenuProductName"></span></a>
							<ul class="nav" id="idMainMenuList">
								<li class="dropdown" id="idOutlinerMenu"> 
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">Outliner&nbsp;<b class="caret"></b></a>
									<ul class="dropdown-menu">
										<li><a onclick="opExpand ();"><span class="menuKeystroke">Cmd-,</span>Expand</a></li>
										<li><a onclick="opExpandAllLevels ();">Expand All Subs</a></li>
										<li><a onclick="opExpandEverything ();">Expand Everything</a></li>
										
										<li class="divider"></li>
										<li><a onclick="opCollapse ();"><span class="menuKeystroke">Cmd-.</span>Collapse</a></li>
										<li><a onclick="opCollapseEverything ();">Collapse Everything</a></li>
										
										<li class="divider"></li>
										<li><a onclick="opReorg (up, 1);"><span class="menuKeystroke">Cmd-U</span>Move Up</a></li>
										<li><a onclick="opReorg (down, 1);"><span class="menuKeystroke">Cmd-D</span>Move Down</a></li>
										<li><a onclick="opReorg (left, 1);"><span class="menuKeystroke">Cmd-L</span>Move Left</a></li>
										<li><a onclick="opReorg (right, 1);"><span class="menuKeystroke">Cmd-R</span>Move Right</a></li>
										
										<li class="divider"></li>
										<li><a onclick="opPromote ();"><span class="menuKeystroke">Cmd-[</span>Promote</a></li>
										<li><a onclick="opDemote ();"><span class="menuKeystroke">Cmd-]</span>Demote</a></li>
										
										<li class="divider"></li>
										<li><a onclick="runSelection ();"><span class="menuKeystroke">Cmd-/</span>Run Selection</a></li>
										<li><a onclick="toggleComment ();"><span class="menuKeystroke">Cmd-\</span>Toggle Comment</a></li>
										
										<li class="divider"></li>
										<li><a onclick="toggleRenderMode ();"><span class="menuKeystroke">Cmd-`</span>Toggle Render Mode</a></li>
										</ul>
									</li>
                                    
                                <li class="dropdown" id="idOwlMenu"> 
								    <a href="#" class="dropdown-toggle" data-toggle="dropdown">OWL&nbsp;<b class="caret"></b></a>
								    <ul class="dropdown-menu">
									    <li><a href="https://github.com/interstar/OWL">About OWL (README on GitHub)</a></li>
									    <li><a href="https://github.com/scripting/concord">Original Concord Project</a></li>
									    <li><a href="http://docs.fargo.io/outlinerHowto/">The SmallPicture Outliner Howto</a></li>
									    
									    <li><a href="http://project.thoughtstorms.info">Project ThoughtStorms</a></li>
									    
							        </ul>
							        </li>
								    
			
								</ul>
							<ul class="nav pull-right">
								<li>
									<a href="#" class="dropdown-toggle" data-toggle="dropdown"><span id="idProductVersion"></span></a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
			

	        
		<div class="divOutlinerContainer">

            <div class="fptNavBar">
                <button class="button" id="backButton">&lt;</button>
                <button class="button" id="forwardButton">&gt;</button>
                <input  id="navPageName" />
                <button class="button" id="goButton">Go!</button>
                <button class="button" id="makeLinkButton">Link</button>
                <!--button class="button" id="testButton">Test</button-->
                </div>

            <div>&nbsp;</div>
          
			<div id="outliner">
				</div>
			</div>
		<script>

			function startup () {
				initLocalStorage ();
				$("#idMenuProductName").text (appConsts.productname);
				$("#idProductVersion").text ("v" + appConsts.version);
				//init menu keystrokes
					if (navigator.platform.toLowerCase ().substr (0, 3) == "mac") {
						cmdKeyPrefix = "&#8984;";
						}
					$("#idMenubar .dropdown-menu li").each (function () {
						var li = $(this);
						var liContent = li.html ();
						liContent = liContent.replace ("Cmd-", cmdKeyPrefix);
						li.html (liContent);
						});
				setOutlinerPrefs ("#outliner", true, false);
				opSetFont (appPrefs.outlineFont, appPrefs.outlineFontSize, appPrefs.outlineLineHeight); 
				
				$("#goButton").click(function(event) { goButton(); });
				$("#backButton").click(function(event) { backButton();  });
				$("#forwardButton").click(function(event) { forwardButton();  });

				$("#makeLinkButton").click(function(event) { makeLink(); });				
				
			
			    path = window.location.pathname + window.location.hash;
			    console.log(path);
			    console.l
			    if (path.indexOf("#") >= 0) {
			        parts = path.split("#");
			        pageName = parts[parts.length-1];
			    } else {
			        pageName = "HelloWorld";
			    }
			    console.log(pageName);
			    
			    pageStore = new BrowserBasedPageStore();			
			    pageStore.get("HelloWorld", function (page) { currentPage = page; });

				editPage (pageName);
				navHistory.newForward(pageName);				
				
				self.setInterval (function () {backgroundProcess ()}, 30000); //call every 30 seconds
				}
		
		
			$(document).ready (function () {
				startup ();
				});
			</script>
		</body>
	</html>
